TiSASRec数据集

2025-12-03 16:20:43.574715: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1764778843.595153   18896 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1764778843.601207   18896 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1764778843.616865   18896 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1764778843.616892   18896 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1764778843.616897   18896 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1764778843.616900   18896 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-12-03 16:20:43.621544: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Namespace(model_name='TiSASRec', model_mode='')
--------------------------------------------- BEGIN: 2025-12-03 16:20:48 ---------------------------------------------

===========================================
 Arguments          | Values               
===========================================
 batch_size         | 256                 
 data_appendix      |                     
 dataset            | Grocery_and_Gourm...
 dropout            | 0                   
 early_stop         | 10                  
 emb_size           | 64                  
 epoch              | 200                 
 eval_batch_size    | 256                 
 gpu                | 0                   
 history_max        | 20                  
 l2                 | 1e-06               
 lr                 | 0.0001              
 main_metric        |                     
 num_heads          | 1                   
 num_layers         | 1                   
 num_neg            | 1                   
 num_workers        | 5                   
 optimizer          | Adam                
 random_seed        | 0                   
 save_final_results | 1                   
 test_all           | 0                   
 time_max           | 512                 
 topk               | 5,10,20,50          
===========================================
Device: cuda
Load corpus from data/Grocery_and_Gourmet_Food/SeqReader.pkl
#params: 647104
TiSASRec(
  (i_embeddings): Embedding(8714, 64)
  (p_k_embeddings): Embedding(21, 64)
  (p_v_embeddings): Embedding(21, 64)
  (t_k_embeddings): Embedding(513, 64)
  (t_v_embeddings): Embedding(513, 64)
  (transformer_block): ModuleList(
    (0): TimeIntervalTransformerLayer(
      (masked_attn_head): TimeIntervalMultiHeadAttention(
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
  )
)
/usr/local/lib/python3.12/dist-packages/torch/utils/data/dataloader.py:627: UserWarning: This DataLoader will create 5 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
Test Before Training: (HR@5:0.0525,NDCG@5:0.0311,HR@10:0.1070,NDCG@10:0.0485,HR@20:0.2058,NDCG@20:0.0731,HR@50:0.5057,NDCG@50:0.1316)
Optimizer: Adam
/usr/local/lib/python3.12/dist-packages/torch/utils/data/dataloader.py:627: UserWarning: This DataLoader will create 5 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
Epoch 1     loss=0.6249 [10.1 s]	dev=(HR@5:0.2442,NDCG@5:0.1611) [1.2 s] *
Epoch 2     loss=0.5076 [9.1 s]	dev=(HR@5:0.2509,NDCG@5:0.1643) [0.8 s] *
Epoch 3     loss=0.4534 [9.9 s]	dev=(HR@5:0.2721,NDCG@5:0.1788) [0.7 s] *
Epoch 4     loss=0.4211 [10.0 s]	dev=(HR@5:0.3010,NDCG@5:0.2009) [0.7 s] *
Epoch 5     loss=0.3946 [9.8 s]	dev=(HR@5:0.3209,NDCG@5:0.2166) [0.9 s] *
Epoch 6     loss=0.3737 [8.6 s]	dev=(HR@5:0.3320,NDCG@5:0.2270) [0.8 s] *
Epoch 7     loss=0.3568 [9.8 s]	dev=(HR@5:0.3421,NDCG@5:0.2344) [0.8 s] *
Epoch 8     loss=0.3413 [10.0 s]	dev=(HR@5:0.3490,NDCG@5:0.2409) [0.8 s] *
Epoch 9     loss=0.3257 [10.0 s]	dev=(HR@5:0.3575,NDCG@5:0.2479) [0.7 s] *
Epoch 10    loss=0.3104 [8.6 s]	dev=(HR@5:0.3668,NDCG@5:0.2564) [1.3 s] *
Epoch 11    loss=0.2960 [9.2 s]	dev=(HR@5:0.3757,NDCG@5:0.2633) [0.8 s] *
Epoch 12    loss=0.2821 [10.2 s]	dev=(HR@5:0.3802,NDCG@5:0.2687) [0.8 s] *
Epoch 13    loss=0.2687 [10.4 s]	dev=(HR@5:0.3883,NDCG@5:0.2772) [0.8 s] *
Epoch 14    loss=0.2570 [9.9 s]	dev=(HR@5:0.3961,NDCG@5:0.2845) [1.0 s] *
Epoch 15    loss=0.2460 [8.8 s]	dev=(HR@5:0.4005,NDCG@5:0.2899) [0.8 s] *
Epoch 16    loss=0.2343 [10.0 s]	dev=(HR@5:0.4056,NDCG@5:0.2937) [0.8 s] *
Epoch 17    loss=0.2222 [10.2 s]	dev=(HR@5:0.4119,NDCG@5:0.2995) [0.7 s] *
Epoch 18    loss=0.2119 [10.0 s]	dev=(HR@5:0.4177,NDCG@5:0.3057) [0.8 s] *
Epoch 19    loss=0.2008 [9.4 s]	dev=(HR@5:0.4188,NDCG@5:0.3070) [1.3 s] *
Epoch 20    loss=0.1921 [8.7 s]	dev=(HR@5:0.4237,NDCG@5:0.3126) [0.7 s] *
Epoch 21    loss=0.1800 [10.0 s]	dev=(HR@5:0.4264,NDCG@5:0.3155) [0.7 s] *
Epoch 22    loss=0.1719 [10.3 s]	dev=(HR@5:0.4279,NDCG@5:0.3183) [0.8 s] *
Epoch 23    loss=0.1643 [10.1 s]	dev=(HR@5:0.4296,NDCG@5:0.3199) [0.8 s] *
Epoch 24    loss=0.1572 [8.5 s]	dev=(HR@5:0.4329,NDCG@5:0.3223) [1.0 s] *
Epoch 25    loss=0.1481 [9.7 s]	dev=(HR@5:0.4327,NDCG@5:0.3244) [0.8 s] *
Epoch 26    loss=0.1410 [10.0 s]	dev=(HR@5:0.4346,NDCG@5:0.3266) [0.7 s] *
Epoch 27    loss=0.1349 [10.0 s]	dev=(HR@5:0.4360,NDCG@5:0.3282) [0.7 s] *
Epoch 28    loss=0.1284 [9.4 s]	dev=(HR@5:0.4374,NDCG@5:0.3310) [1.2 s] *
Epoch 29    loss=0.1216 [8.5 s]	dev=(HR@5:0.4368,NDCG@5:0.3305) [0.7 s]
Epoch 30    loss=0.1151 [9.9 s]	dev=(HR@5:0.4389,NDCG@5:0.3332) [0.7 s] *
Epoch 31    loss=0.1100 [10.0 s]	dev=(HR@5:0.4392,NDCG@5:0.3340) [0.7 s] *
Epoch 32    loss=0.1057 [9.0 s]	dev=(HR@5:0.4393,NDCG@5:0.3345) [1.1 s] *
Epoch 33    loss=0.1011 [8.3 s]	dev=(HR@5:0.4387,NDCG@5:0.3351) [0.7 s] *
Epoch 34    loss=0.0962 [9.9 s]	dev=(HR@5:0.4400,NDCG@5:0.3380) [0.7 s] *
Epoch 35    loss=0.0923 [9.7 s]	dev=(HR@5:0.4391,NDCG@5:0.3366) [0.8 s]
Epoch 36    loss=0.0872 [9.0 s]	dev=(HR@5:0.4410,NDCG@5:0.3384) [1.2 s] *
Epoch 37    loss=0.0838 [8.6 s]	dev=(HR@5:0.4410,NDCG@5:0.3381) [0.7 s]
Epoch 38    loss=0.0807 [9.7 s]	dev=(HR@5:0.4393,NDCG@5:0.3376) [0.7 s]
Epoch 39    loss=0.0772 [9.7 s]	dev=(HR@5:0.4387,NDCG@5:0.3375) [0.7 s]
Epoch 40    loss=0.0729 [9.1 s]	dev=(HR@5:0.4393,NDCG@5:0.3386) [1.1 s] *
Epoch 41    loss=0.0709 [8.3 s]	dev=(HR@5:0.4369,NDCG@5:0.3362) [0.7 s]
Epoch 42    loss=0.0680 [9.7 s]	dev=(HR@5:0.4374,NDCG@5:0.3374) [0.7 s]
Epoch 43    loss=0.0649 [9.9 s]	dev=(HR@5:0.4387,NDCG@5:0.3382) [0.7 s]
Epoch 44    loss=0.0626 [8.8 s]	dev=(HR@5:0.4348,NDCG@5:0.3353) [1.2 s]
Epoch 45    loss=0.0585 [8.5 s]	dev=(HR@5:0.4373,NDCG@5:0.3376) [0.7 s]
Epoch 46    loss=0.0579 [9.9 s]	dev=(HR@5:0.4349,NDCG@5:0.3364) [0.7 s]
Epoch 47    loss=0.0562 [9.8 s]	dev=(HR@5:0.4344,NDCG@5:0.3368) [0.7 s]
Epoch 48    loss=0.0534 [8.8 s]	dev=(HR@5:0.4347,NDCG@5:0.3365) [1.2 s]
Epoch 49    loss=0.0511 [8.7 s]	dev=(HR@5:0.4361,NDCG@5:0.3388) [0.7 s] *
Epoch 50    loss=0.0498 [9.7 s]	dev=(HR@5:0.4352,NDCG@5:0.3386) [0.7 s]
Epoch 51    loss=0.0472 [9.7 s]	dev=(HR@5:0.4331,NDCG@5:0.3360) [0.7 s]
Epoch 52    loss=0.0468 [9.0 s]	dev=(HR@5:0.4338,NDCG@5:0.3371) [1.2 s]
Epoch 53    loss=0.0447 [8.5 s]	dev=(HR@5:0.4344,NDCG@5:0.3366) [0.7 s]
Epoch 54    loss=0.0429 [9.8 s]	dev=(HR@5:0.4316,NDCG@5:0.3354) [0.7 s]
Epoch 55    loss=0.0418 [9.9 s]	dev=(HR@5:0.4327,NDCG@5:0.3360) [0.7 s]
Epoch 56    loss=0.0399 [8.7 s]	dev=(HR@5:0.4318,NDCG@5:0.3359) [1.1 s]
Epoch 57    loss=0.0392 [8.4 s]	dev=(HR@5:0.4319,NDCG@5:0.3349) [0.7 s]
Epoch 58    loss=0.0382 [9.8 s]	dev=(HR@5:0.4351,NDCG@5:0.3379) [0.7 s]
Early stop at 58 based on dev result.

Best Iter(dev)=   49	 dev=(HR@5:0.4361,NDCG@5:0.3388) [597.3 s] 
Load model from ../model/TiSASRec/TiSASRec__Grocery_and_Gourmet_Food__0__lr=0.0001__l2=1e-06__emb_size=64__num_layers=1__num_heads=1__time_max=512.pt
                                                                                                    
Dev  After Training: (HR@5:0.4361,NDCG@5:0.3388,HR@10:0.5252,NDCG@10:0.3675,HR@20:0.6308,NDCG@20:0.3942,HR@50:0.8144,NDCG@50:0.4306)
                                                                                                    
Test After Training: (HR@5:0.3902,NDCG@5:0.2941,HR@10:0.4821,NDCG@10:0.3238,HR@20:0.5852,NDCG@20:0.3498,HR@50:0.7794,NDCG@50:0.3881)
Saving top-100 recommendation results to: ../log/TiSASRec/TiSASRec__Grocery_and_Gourmet_Food__0__lr=0/rec-TiSASRec-dev.csv
dev Prediction results saved!
Saving top-100 recommendation results to: ../log/TiSASRec/TiSASRec__Grocery_and_Gourmet_Food__0__lr=0/rec-TiSASRec-test.csv
/usr/local/lib/python3.12/dist-packages/torch/utils/data/dataloader.py:627: UserWarning: This DataLoader will create 5 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
test Prediction results saved!

--------------------------------------------- END: 2025-12-03 16:31:02 ---------------------------------------------